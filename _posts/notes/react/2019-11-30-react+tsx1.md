---
layout: post
title:  "React+tsx1"
date:   2019-11-30 14:20:41 +0800
categories: notes react typescript
tags: react typescript Ethernal 路径 事件
excerpt: "使用typescript+react新建项目"
---

我们学了一个新的框架，首先自然是基础的学习，学习相关的概念，然后是开始做网页。我们使用脚手架工具搭建了一个工程后学习与工作的流程应该是：

1. 首先应该明白代码文件的结构是什么，找到主页。

2. 明白主页结构后，将主页所有代码删除，开始写主页的布局并加上样式。

3. 完成整个页面后开始写逻辑文件，从js中明白各个框架的不同。

4. 将部分代码剥离出去变成组件，将一个完整的页面不断组件化。

5. 完成一个页面后再思考这个框架如何使用路由，变成多页面网页。

6. 不断学习并找到新的问题。

首先安装和搭建都是和一般的一样，就不多赘述了。然后将注意的是我将前端放在web文件夹中。因为需要使用typescript，所以要将js文件改为tsx文件，并安装typescript。

## 更改相关配置路径

虽然我之前改过相关配置路径，如index.html位置等，但是我感觉还是原来的位置最方便，所以最后又重新改了回来。

更改方法是：寻找node_modules/react-script/config/paths.js将module.exports所有需要更改的地方都更改过来就行了。

&emsp;

## 事件处理函数

react使用js和ts有许多不同。因为ts对比js更严格，所以从函数来说它的说明要更严格，从事件处理绑定来说，react官方文档是如此说明的：`事件名={没有后面括号的函数名}`。

但是使用ts后，如果一个函数在class也就是在组件中定义，那就必须要在函数名前加上this，即`事件名={this.函数名}`。但是如你就这样使用了函数，那一定会报错，如：TypeError: Cannot read property 'state' of undefined，我这个函数是改变组件状态的函数，我们会这时感觉很奇怪，我这个函数不在状态里面定义的啊，而是在外面定义的，且要改变的状态已经定义了，怎么说不能读取未定义的状态呢？是因为你点击的是这个按钮，那么这个this就是指向被你点击到的对象而不是你的要改变的对象，所以这时我们一般有两种解决方案：

1. 手动绑定this  
最后的格式就是`事件名=this.函数名.bind(this)`。这时的这个this，就是默认的指向整个组件。

2. ES6箭头函数
因为箭头函数默认的this是声明该函数的定义域的this，在此就是这个组件的this。

而如果一个函数在class外也就是在组件外定义，那就没有前面的this，其他的地方都是一样的，都需要绑定this。

&emsp;

但是如果你使用的是function函数式定义组件，那么就不需要绑定this，按原来的使用函数就可以了，因为函数式声明this是默认指向函数定义域的。
